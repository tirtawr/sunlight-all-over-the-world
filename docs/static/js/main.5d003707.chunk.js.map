{"version":3,"sources":["getDarknessPolygon.js","helpers.js","getPopulationInDaylight.js","DateSlider.js","Map.js","App.js","index.js"],"names":["getDarknessPolygon","date","angle","darkPosition","sunPosition","sunLng","geometry","coordinates","darkLng","darkLat","geoJsonPoint","getLat","point","getDarknessCenteroid","rad","ms_past_midnight","Date","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","jc","getTime","mean_long_sun","mean_anom_sun","sun_app_long","Math","sin","obliq_corr","cos","lat","asin","eccent","y","tan","true_solar_time_in_deg","lng","getSunCenteroid","radius","PI","earth_radius_in_meters","circle","steps","units","getPopulation","longitude","latitude","floor","lngIdx","population","getPopulationInDaylight","darknessPolygon","total","steradianPopulation","steradianCenteroid","isInside","round","DateSlider","value","onChange","onAfterChange","className","step","min","max","tooltip","tooltipPlacement","tooltipLabel","val","parseInt","abs","tooltipStyle","Map","currentDate","useState","map","setMap","mapContainer","useRef","useEffect","mapboxgl","accessToken","container","current","style","center","zoom","on","addSource","addLayer","fitBounds","padding","top","bottom","left","right","initializeMap","getSource","setData","ref","App","useCountUp","start","end","duration","separator","useEasing","displayedPopulationCount","countUp","setDisplayedPopulationCount","update","togglePopulationCountAnimation","pauseResume","displayedPopulationDiffPerSecond","setDisplayedPopulationDiffPerSecond","togglePopulationDiffPerSecondAnimation","populationPercentage","setPopulationPercentage","togglePopulationPercentageAnimation","targetPopulationCount","setTargetPopulationCount","populationCount","setPopulationCount","populationDiffPerSecond","setPopulationDiffPerSecond","setCurrentDate","hourOffset","setHourOffset","miniTickInterval","setMiniTickInterval","target","diffPerSecond","counter","miniTick","clearInterval","setInterval","easedSetPopulationCount","initialPopulationCount","Container","Row","Col","changeEvent","event","offset","href","rel","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5d003707.chunk.js","sourcesContent":["import { point, circle } from '@turf/turf'\nimport { getLng, getLat } from './helpers'\n\n// Adapted from https://github.com/rossengeorgiev/nite-overlay/blob/master/nite-overlay.js\nfunction getSunCenteroid(date) {\n  date = (date instanceof Date) ? date : new Date();\n\n  var rad = 0.017453292519943295;\n  // based on NOAA solar calculations\n  var ms_past_midnight = ((date.getUTCHours() * 60 + date.getUTCMinutes()) * 60 + date.getUTCSeconds()) * 1000 + date.getUTCMilliseconds();\n  var jc = (((date.getTime() / 86400000.0) + 2440587.5) - 2451545) / 36525;\n  var mean_long_sun = (280.46646 + jc * (36000.76983 + jc * 0.0003032)) % 360;\n  var mean_anom_sun = 357.52911 + jc * (35999.05029 - 0.0001537 * jc);\n  var sun_eq = Math.sin(rad * mean_anom_sun) * (1.914602 - jc * (0.004817 + 0.000014 * jc)) + Math.sin(rad * 2 * mean_anom_sun) * (0.019993 - 0.000101 * jc) + Math.sin(rad * 3 * mean_anom_sun) * 0.000289;\n  var sun_true_long = mean_long_sun + sun_eq;\n  var sun_app_long = sun_true_long - 0.00569 - 0.00478 * Math.sin(rad * 125.04 - 1934.136 * jc);\n  var mean_obliq_ecliptic = 23 + (26 + ((21.448 - jc * (46.815 + jc * (0.00059 - jc * 0.001813)))) / 60) / 60;\n  var obliq_corr = mean_obliq_ecliptic + 0.00256 * Math.cos(rad * 125.04 - 1934.136 * jc);\n  var lat = Math.asin(Math.sin(rad * obliq_corr) * Math.sin(rad * sun_app_long)) / rad;\n  var eccent = 0.016708634 - jc * (0.000042037 + 0.0000001267 * jc);\n  var y = Math.tan(rad * (obliq_corr / 2)) * Math.tan(rad * (obliq_corr / 2));\n  var rq_of_time = 4 * ((y * Math.sin(2 * rad * mean_long_sun) - 2 * eccent * Math.sin(rad * mean_anom_sun) + 4 * eccent * y * Math.sin(rad * mean_anom_sun) * Math.cos(2 * rad * mean_long_sun) - 0.5 * y * y * Math.sin(4 * rad * mean_long_sun) - 1.25 * eccent * eccent * Math.sin(2 * rad * mean_anom_sun)) / rad);\n  var true_solar_time_in_deg = ((ms_past_midnight + rq_of_time * 60000) % 86400000) / 240000;\n  var lng = -((true_solar_time_in_deg < 0) ? true_solar_time_in_deg + 180 : true_solar_time_in_deg - 180);\n\n  return point([lng, lat]);\n}\n\nfunction getDarknessCenteroid(sunPosition) {\n  const sunLng = getLng(sunPosition);\n  const sunLat = getLat(sunPosition);\n  const darkLng = (sunLng + 180) > 180 ? (sunLng - 180) : (sunLng + 180)\n  const darkLat = -sunLat;\n\n  return point([darkLng, darkLat])\n}\n\n// Adapted from https://github.com/rossengeorgiev/nite-overlay/blob/master/nite-overlay.js\n// angle is in degrees, returns radius in kilometers\n//    Notes:\n//    astronomical twilight -> 18 degrees\n//    nautical twilight -> 12 degrees\n//    civil twilight -> 6 degrees\nfunction getDarknessRadiusFromAngle(angle) {\n  var earth_radius_in_meters = 6371008\n  var shadow_radius = earth_radius_in_meters * Math.PI * 0.5;\n  var twilight_dist = ((earth_radius_in_meters * 2 * Math.PI) / 360) * angle;\n  return (shadow_radius - twilight_dist) / 1000;\n};\n\nfunction getDarknessPolygon(date) {\n  date = (date instanceof Date) ? date : new Date();\n\n  const sunPosition = getSunCenteroid(date);\n  const darkPosition = getDarknessCenteroid(sunPosition)\n  const radius = getDarknessRadiusFromAngle(6); // use civil twilight\n  const options = { steps: 360, units: 'kilometers' };\n  return circle(darkPosition, radius, options);\n}\n\nexport default getDarknessPolygon;","export function getLat(geoJsonPoint) {\n  return geoJsonPoint.geometry.coordinates[1]\n}\n\nexport function getLng(geoJsonPoint) {\n  return geoJsonPoint.geometry.coordinates[0]\n}\n","// import { point } from '@turf/turf'\n\nimport population from './population.json';\nimport getDarknessPolygon from './getDarknessPolygon'\nimport { point, booleanPointInPolygon as isInside } from '@turf/turf'\n\n// Returns the number of people residing in a steradian of 1 degree lng by 1 degree lat\nfunction getPopulation(longitude, latitude) {\n  // get north-east point of the steradian\n  const lng = Math.floor(longitude);\n  const lat = Math.floor(latitude);\n\n  const lngIdx = lng + 180;\n  const latIdx = -lat + 90;\n\n  return population[latIdx][lngIdx];\n}\n\nfunction getPopulationInDaylight(date) {\n  date = (date instanceof Date) ? date : new Date();\n\n  const darknessPolygon = getDarknessPolygon(date);\n  let total = 0;\n\n  for (let lat = 90; lat > -90; lat--) {\n    for (let lng = -180; lng < 180; lng++) {\n      const steradianPopulation = getPopulation(lng, lat);\n      if (steradianPopulation > 0) {\n        const steradianCenteroid = point([lng + 0.5, lat + 0.5])\n        if (!isInside(steradianCenteroid, darknessPolygon)) {\n          total += steradianPopulation\n        }\n      }\n    }\n  }\n\n  return Math.round(total);\n}\n\nexport default getPopulationInDaylight;\n","import React from \"react\";\nimport RangeSlider from 'react-bootstrap-range-slider';\n\nfunction DateSlider({ value, onChange, onAfterChange }) {\n\n  const tooltipLabelFormatter = ((value) => {\n    const val = parseInt(value)\n    if (val === 0) {\n      return 'Now'\n    } else if (val > 0) {\n      if (val === 1) {\n        return `${val} Hour from now`\n      } else {\n        return `${val} Hours from now`\n      }\n    } else {\n      if (val === -1) {\n        return `${Math.abs(val)} hour ago`\n      } else {\n        return `${Math.abs(val)} hours ago`\n      }\n    }\n  })\n\n  return (\n    <div className=\"date-slider\">\n      <RangeSlider\n        value={value}\n        onChange={onChange}\n        onAfterChange={onAfterChange}\n        step={1}\n        min={-24}\n        max={24}\n        tooltip={'on'}\n        tooltipPlacement={'top'}\n        tooltipLabel={tooltipLabelFormatter}\n        tooltipStyle={{\n          'fontFamily': \"'Poppins', sans-serif\"\n        }}\n      />\n    </div>\n  )\n}\n\nexport default DateSlider;","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useState, useRef } from \"react\";\nimport mapboxgl from 'mapbox-gl';\n\nimport getDarknessPolygon from './getDarknessPolygon'\n\nfunction Map({ currentDate }) {\n  const [map, setMap] = useState(null);\n  const mapContainer = useRef(null);\n\n  useEffect(() => {\n    mapboxgl.accessToken = 'pk.eyJ1Ijoic2V0YXBhazIwMTkiLCJhIjoiY2szdzJhdGx3MDVpaDNpcGltZ3luNDUyMSJ9.lwsV4FsgU1SfbS6QRFlO_A';\n    const initializeMap = ({ setMap, mapContainer }) => {\n      const map = new mapboxgl.Map({\n        container: mapContainer.current,\n        style: \"mapbox://styles/mapbox/streets-v11\",\n        center: [0, 0],\n        zoom: 0\n      });\n\n      map.on('load', () => {\n        setMap(map);\n\n        map.addSource('darkness', {\n          'type': 'geojson',\n          'data': getDarknessPolygon(currentDate)\n        });\n\n        map.addLayer({\n          'id': 'darkness',\n          'type': 'fill',\n          'source': 'darkness',\n          'layout': {},\n          'paint': {\n            'fill-color': '#000000',\n            'fill-opacity': 0.2\n          }\n        });\n\n        map.fitBounds([[-180, 90], [180, -50]], {\n          padding: { top: 0, bottom: 0, left: 0, right: 0 }\n        });\n      });\n\n    };\n\n    if (!map) initializeMap({ setMap, mapContainer });\n  }, [map]);\n\n  useEffect(() => {\n    if (map) map.getSource('darkness').setData(getDarknessPolygon(currentDate));\n  }, [currentDate])\n\n  return (\n    <>\n      <div ref={mapContainer} className=\"map-container\"></div>\n    </>\n  );\n}\n\nexport default Map;\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useState, useEffect } from 'react';\nimport { useCountUp } from 'react-countup';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\n\nimport getPopulationInDaylight from './getPopulationInDaylight'\nimport DateSlider from './DateSlider'\nimport Map from './Map'\n\nimport './App.css';\n\nfunction App() {\n  const { countUp: displayedPopulationCount, update: setDisplayedPopulationCount, pauseResume: togglePopulationCountAnimation } = useCountUp({\n    start: 0,\n    end: 0,\n    duration: 1,\n    separator: ',',\n    useEasing: false\n  });\n\n  const { countUp: displayedPopulationDiffPerSecond, update: setDisplayedPopulationDiffPerSecond, pauseResume: togglePopulationDiffPerSecondAnimation } = useCountUp({\n    start: 0,\n    end: 0,\n    duration: 1,\n    separator: ',',\n    useEasing: true\n  });\n\n  const { countUp: populationPercentage, update: setPopulationPercentage, pauseResume: togglePopulationPercentageAnimation } = useCountUp({\n    start: 0,\n    end: 0,\n    duration: 1,\n    separator: ',',\n    useEasing: true\n  });\n\n  const [targetPopulationCount, setTargetPopulationCount] = useState(0)\n  const [populationCount, setPopulationCount] = useState(0)\n  const [populationDiffPerSecond, setPopulationDiffPerSecond] = useState(0)\n  const [currentDate, setCurrentDate] = useState(new Date())\n  const [hourOffset, setHourOffset] = useState(0)\n  const [miniTickInterval, setMiniTickInterval] = useState(null)\n\n  useEffect(() => {\n    setCurrentDate(new Date(new Date().getTime() + hourOffset * 60 * 60 * 1000))\n  }, [hourOffset])\n\n  const easedSetPopulationCount = (target) => {\n    let current = populationCount;\n    const diffPerSecond = (target - populationCount) / 300;\n    setPopulationDiffPerSecond(diffPerSecond)\n    let counter = 0;\n    const miniTick = () => {\n      if (counter >= 300) {\n        clearInterval(miniTickInterval)\n        setPopulationCount(current)\n      }\n      current += diffPerSecond\n      togglePopulationCountAnimation()\n      setDisplayedPopulationCount(current)\n      counter++\n    }\n    miniTick()\n    const miniTickInterval = setInterval(miniTick, 1 * 1000)\n    setMiniTickInterval(miniTickInterval)\n  }\n\n  useEffect(() => {\n    if (populationDiffPerSecond === 0) return; \n    togglePopulationDiffPerSecondAnimation()\n    setDisplayedPopulationDiffPerSecond(Math.abs(Math.round(populationDiffPerSecond)))\n  }, [populationDiffPerSecond])\n\n  useEffect(() => {\n    if (populationCount > 0) {\n      togglePopulationPercentageAnimation()\n      setPopulationPercentage(Math.round(populationCount / 7800000000 * 100))\n      const target = getPopulationInDaylight(new Date(currentDate.getTime() + 5 * 60 * 1000))\n      setTargetPopulationCount(target)\n    }\n  }, [populationCount])\n\n  useEffect(() => {\n    if (targetPopulationCount > 0) {\n      easedSetPopulationCount(targetPopulationCount)\n    }\n  }, [targetPopulationCount])\n\n  useEffect(() => {\n    const initialPopulationCount = getPopulationInDaylight(currentDate)\n    \n    setDisplayedPopulationCount(initialPopulationCount)\n    setPopulationCount(initialPopulationCount)\n  }, [])\n\n  // a hack to avoid precalculation\n  const onDateChanged = (event) => {\n    const offset = event.target.value\n    setPopulationCount(getPopulationInDaylight(new Date(new Date().getTime() + offset * 60 * 60 * 1000)))\n    clearInterval(miniTickInterval)\n  }\n\n  return (\n    <div className=\"page-container\">\n      <main>\n        <Container className=\"px-5 pt-5\">\n          <Row>\n            <Col>\n              <h1 className=\"text-center\">Sunlight All Over The World</h1>\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <Map currentDate={currentDate} />\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <DateSlider\n                value={hourOffset}\n                onChange={changeEvent => setHourOffset(changeEvent.target.value)}\n                onAfterChange={onDateChanged}\n                step={1}\n                min={-24}\n                max={24}\n              />\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <div className=\"population-count-label\">\n                Number of people currently receiving sunlight:\n          </div>\n              <div className=\"population-count\">\n                {displayedPopulationCount}\n              </div>\n            </Col>\n          </Row>\n          <Row>\n            <div className=\"fun-fact\">\n              <span className=\"fun-fact-number mr-2\">{`${populationPercentage}%`}</span>\n              <span>{` of the world's population are receiving sunlight`}</span>\n\n            </div>\n          </Row>\n          <Row>\n            <div className=\"fun-fact\">\n              <span>{`Every second, `}</span>\n              <span className=\"fun-fact-number mx-2\">{`${displayedPopulationDiffPerSecond} ${populationDiffPerSecond > 0 ? 'More' : 'Less'}`}</span>\n              <span>{` people are receiving sunlight`}</span>\n            </div>\n          </Row>\n          <Row>\n            <Col>\n              <div className=\"description\">\n                <p>\n                  The sun is something we all share. Each day (for the most part) we take turns in enjoying our marvelous sun. Exposure to sunlight increases the brain’s release of serotonin, stabilizing our mood and increasing feelings of well-being.\n                </p>\n                <p>\n                  This calculation uses United Nation's 2020 world population distribution estimate gathered through <a href=\"https://sedac.ciesin.columbia.edu/data/set/gpw-v4-admin-unit-center-points-population-estimates-rev11/data-download\" target=\"_blank\" rel=\"noopener noreferrer\">NASA’s Socioeconomic Data and Applications Center (SEDAC)</a>.\n                </p>\n                <p>\n                  Sunlight is defined by the duration between civil dawn and civil twilight, when the sun is 6 degrees below the horizon. <a href=\"https://www.timeanddate.com/astronomy/different-types-twilight.html\" target=\"_blank\" rel=\"noopener noreferrer\">Learn more</a>\n                </p>\n              </div>\n            </Col>\n          </Row>\n        </Container>\n      </main>\n      <footer>\n        Made with ♥ by <a href=\"https://tirtawr.com\" target=\"_blank\" rel=\"noopener noreferrer\">Tirta Rachman</a> - <a href=\"https://github.com/tirtawr/sunlight-all-over-the-world\" target=\"_blank\" rel=\"noopener noreferrer\">View on GitHub</a> - <a href=\"https://github.com/tirtawr/sunlight-all-over-the-world/issues\" target=\"_blank\" rel=\"noopener noreferrer\">Sugest an improvement</a>\n      </footer>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'react-bootstrap-range-slider/dist/react-bootstrap-range-slider.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}